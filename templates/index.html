<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Route Pyramid</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
    {{ font_awesome.load_js() }}
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/styles.css') }}"
    />
</head>
<body>

 <div  class="content">
     <div id='filters'>
         Jordan's Pyramid
         <form method="POST">
    {{ form.csrf_token }}
    {{ form.climbing_style }}
    {{ form.grade }}
    <input type="submit">
    </form>
     <script>
        let style_select = document.getElementById('climbing_style');
        let grade_select = document.getElementById('grade');

        style_select.onchange = function() {
            style = style_select.value;

            fetch('/grades/' + style).then(function(response) {
                response.json().then(function(data) {
                let optionHTML = '';

                for (let grade of data.grades) {
                    optionHTML +=  '<option value ="' + grade.id + '">' + grade.grade + '</option>';
                }

                grade_select.innerHTML = optionHTML;

                });

            });

         }
     </script>
     </div>
     <div id='pyramid'>
<!--     {% for send in sends %}-->
<!--{{send.date}} - {{send.route_name}} - {{send.grade}}<br>-->
<!--{% endfor %}-->


{% for layer in layers %}
<div class="layer">
  <div class="blocks">

    <div class="block blocks-no-border">{{layer["grade"]}}</div>
     <div class="all-blocks">
    {% for climb in layer["climbs"] %}
    <div class="block {{climb.ascent}} y{{climb.date[:4]}}">
         <strong>{{ climb.name }}</strong>
        <span class="block-date">{{ climb.date }}</span>
          <div class='icon-container'>
            {% if climb.ascent == "Redpoint" %}
                {{font_awesome.render_icon("fas fa-circle")}}
            {% else %}
                {{font_awesome.render_icon("fas fa-bolt")}}
            {% endif %}
              </div>
             </div>
    {% endfor %}
    </div>
    </div>
   </div>
         {% endfor %}
</div>



         </div>
     </div>
</body>
</html>